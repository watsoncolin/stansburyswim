@page
@model FillThePool.Core.Pages.ScheduleModel
@{
	ViewData["Title"] = "Schedule";
}
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="https://www.paypal.com/sdk/js?client-id=@Model.PayPalClientId"></script>
<div class="container">
	<div class="row">
		<div class="col">
			<h1 class="display-4 text-center">Schedule</h1>
			<br />
			<div id="paypal"></div>
		</div>
	</div>
	<div id="root"></div>
</div>
<script>
	const rootElement = document.getElementById('root');
	ReactDOM.render(React.createElement(window.Schedule), document.getElementById('root'));
</script>

<script>
	paypal.Buttons({
		createOrder: function (data, actions) {
			// Set up the transaction
			return actions.order.create({
				purchase_units: [{
					amount: {
						value: '0.01'
					}
				}]
			});
		},
		onApprove: function (data, actions) {
			return actions.order.capture().then(function (details) {
				alert('Transaction completed by ' + details.payer.name.given_name);
				// Call your server to save the transaction
				return fetch('/api/payments/verify-payment', {
					method: 'post',
					credentials: 'include',
					headers: {
						'content-type': 'application/json'
					},
					body: JSON.stringify({
						orderId: data.orderID
					})
				});
			});
		}
	}).render('#paypal');
</script>